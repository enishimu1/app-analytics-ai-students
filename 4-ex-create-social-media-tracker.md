# 演習 - ソーシャル メディア トラッカー ロジック アプリを作成する

**[Home](./README.md)** - [Next Challenge >](./Challenge-01.md)

この演習では、Azure portal を使用して、ソーシャル メディア ロジック アプリを作成します。 Logic Apps デザイナーを使用して Twitter トリガーを追加します。 次の図は、作業を行う部分が強調表示された、アプリの概念図を示しています。

## Azure ロジック アプリのリソースを見つける
最初にするべきことは、Azure ロジック アプリを作成することです。 これを行うには、[Azure portal](https://portal.azure.com/) で Azure Logic Apps のリソースの種類を見つける必要があります。

1. [Azure portal](https://portal.azure.com/) にサインインします。
1. Azure portal のメニューで [リソースの作成] を選択し、上部の検索ボックスで [ロジック アプリ] と入力します。 [ロジック アプリ] ペインが表示されます。
1. ロジック アプリ画面で[作成] ボタンをクリックします。 [ロジック アプリの作成] ペインが表示されます。

## Azure ロジック アプリのリソースを構成する
リソース グループや場所などの基本的な設定を構成しましょう。

1. [基本] タブで、各設定に対して次の値を入力します。

    |  設定  |  値  |
    | ---- | ---- |
    |  **プロジェクトの詳細**  |
    |  サブスクリプション  |  ご自分のサブスクリプション  |
    |  リソース グループ   |  （新規）リソース グループ<br>　デフォルトでは、ShoeTracker_group となります。  |
    |  **インスタンスの詳細**  |
    |  ロジック アプリ名  |  ShoeTracker  |
    |  リージョン  |  最も近い場所をドロップダウン リストから選択します。  |
    |  プラン  |  消費  |

1. [確認と作成]、[作成] の順に選択します。 [デプロイ] ペインに、作成されたリソースが表示されます。 デプロイが正常に終了するまで待ちます。

## Azure ロジック アプリにテンプレートを使用する
Azure portal でロジック アプリを作成するときに、スターター テンプレートを選択することができます。 一からロジック アプリを構築できるように、空のテンプレートを選択してみましょう。

1. デプロイが完了したら、[リソースに移動] を選択します。 ShoeTracker ロジック アプリの Logic Apps デザイナーが表示されます。
1. 下の [テンプレート] セクションまでスクロールして、[空のロジック アプリ] を選択します。

## Twitter トリガーを作成する
では、トリガーを作成して、すべての必須パラメーターに値を指定してみましょう。

> **注意**
> Twitter アカウントを持っておらず、その作成を希望しない場合は、次のように置き換えます。 [検索] フィールドで "フィード項目が発行される場合" を置き換え、下部のボックスで RSS トリガーを選択します。 [RSS フィードの URL] を `https://rss2.feedspot.com/https://www.reuters.com/technology` に、[Chosen property](選択したプロパティ) を UpdatedOn に、[How often to check for items](項目をチェックする間隔) を `1` に、[頻度] を `分` に設定します。 このアプローチの欠点は、まれに RSS フィードに新しい記事が表示されることがあるため、このトリガーをアクティブにする前にしばらく待つ必要があることです。

1. [コネクタとトリガーを検索] フィールドに「新しい Twitter が投稿されたら」と入力します。 下部のダイアログ ボックスで、Twitter の [新しいツイートが投稿されたら] を選択します。
1. [Twitter] ダイアログ ボックスでは、次の入力を求められます。

    |  設定  |  値  |
    | ---- | ---- |
    | [接続名] | ShoeTrackerTwitterConnection |
    | [Authentication Type] | 既定値 (Use default shared application) をそのまま使用します |

1. [サインイン] をクリックします。 ご自分がお持ちの Twitter アカウントとパスワードを使用してサインインし、[連携アプリを認証] を選択します。 この操作により、Twitter アカウントへのログイン接続が確立されます。
1. Twetter の [新しいツイートが投稿されたら] ダイアログ ボックスが再び表示されれば、有効な接続が作成されています。 ダイアログ ボックスには、3 つの必須パラメーターがあります。

    |  設定  |  値  |
    | ---- | ---- |
    | 検索テキスト | Shoe lang:ja exclude:retweets |
    |  | （ご自身が気になる任意のキーワード） | 
    | 項目を確認する頻度 | 1 |
    | (頻度) | 分 |
    | Add new parameter | 既定値 (空白) をそのまま使用します。 |

1. コマンド バーの [保存] を選択します。
1. [トリガーの実行] を選びます。

## Twitter トリガーの結果を確認する
この時点で、ロジック アプリによって 1 分間隔で検索テキストを含むツイートがあるかどうか、Twitter のスキャンが行われています。 アプリが実行されていて、正常に動作していることを確認するため、[実行の履歴] テーブルを調べます。

1. 左にスクロールし、ロジック アプリのメニューで [概要] を選択します。 ナビゲーション メニューを表示するには、左にスクロールすることが必要な場合があります。または、ブラウザーの検索機能を使用して、ページ上の "概要" という単語を検索することもできます。
1. [実行の履歴] テーブルに行が表示されるまで、1 分ごとに [更新] を選択します。
1. 待っている間に、[概要] で [トリガーの履歴] というラベルの付いたセクションを見つけます。 「過去 24 時間の実行数」と書かれているテキストに注目してください。毎分ポーリングしているため、この数は 1 分ごとに増加するはずです。このケースでは、この数はトリガーが一致するツイートを見つけた回数を表しています。

> **注意**
> 現在 Twitter コネクターの制限によりトリガー ポーリングの頻度が 1 時間に[制限](https://learn.microsoft.com/connectors/twitter/#limits)されています。

1. [実行の履歴] に戻ります。 行が表示されたら、その行を選択します。 行を選択すると、トリガーを作成するために使用したデザイナーのようなビューに移動します。 このビューでは、アプリのこの実行の各ステップを流れたデータを確認できます。
1. Twitter トリガーを選択します。
1. [出力] セクションでデータを調べます。 たとえば、一致するツイートのテキストを見つけます。

> **注意**
> JSON で応答の全体を表示する場合は、[未加工出力の表示] を選択します。

### 次のユニット:[アクションを実行する](https://learn.microsoft.com/training/modules/route-and-process-data-logic-apps/5-execute-an-action)